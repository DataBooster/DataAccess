<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<title>Database Task Parallel Foundation - dbParallel for Oracle &#38; SQL Server</title>
</head>
<body>
<h1><a href="//github.com/DataBooster/DataAccess/">DataBooster - Extension to ADO.NET Data Provider</a></h1>
<div class="wikidoc">
<div><a name="project-description"></a><strong>Project Description</strong></div>
<div>Less Code, Less Configuration, Less Time.<br>
The DataBooster library is a high-performance extension to ADO.NET Data Provider, includes two aspects:</div>
<ul>
<li>A slimmed down API encapsulation which simplified the most common data access operations (DbConnection -&gt; DbCommand -&gt; DbParameter -&gt; DbDataReader) into a single class
<strong><span style="color:#2b91af">DbAccess</span></strong>, to help application with a clean DAL, avoid over-packing and redundant-copy of data transfer. DbAccess also provides an object-relational mapping (OR/M) one-way implementation
<em>(from database to .NET Framework classes)</em> that maximizes the use of inference approach rather than lots of configurations or mechanical designs for redundant metadata. The whole class library comes as a very lightweight NuGet package. Using the library
 is seamless with your existing database developments, please consider using this for your application development if Entity Framework can not meet your performance requirement or Stored-Procedure-Based development is adopted as part of the back-end development
 if your architecture recognizes that <em>&quot;it is far more efficient to process data as close to where the data physically resides as possible&quot;</em>.
</li><li>A booster for writing tremendous amount of data into database. Base on a rational utilization of database concurrency and a effective utilization of network bandwidth, the booster implements a transmitting pipeline of dataflow like a Multiple Launch Rocket
 System, The speed of writing data into database can be improved about 5 times faster than an ordinary bulk insert/copy, or up to 700&#43; times faster than a row-by-row insert.<br>
The detail implement closely depends on the specific database. For the moment, the class
<strong><span style="color:#2b91af">OracleLauncher</span></strong> and <strong><span style="color:#2b91af">SqlLauncher</span></strong> are ready for Oracle and SQL Server. They handle the throughput control and other low-level synchronization details. They
 are thread-safe which avoid locks. By using the Launcher, you can maximize the performance of your code while filling data row-by-row simply.
</li></ul>
<div><img src="Home_Launcher.png" alt="Data Launcher" width="600" height="336" style="vertical-align:middle"></div>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#project-description">Project Description</a> </li><li><a href="#quick-starts">Quick Starts</a>
<ul>
<li><a href="#qs-dbaccess">DbAccess</a>
<ul>
<li><a href="#simple-parameters">Simple Parameters</a> </li><li><a href="#db-bulk">Table-Valued Parameters &amp; PL/SQL Associative Array Parameters</a>
<ul>
<li><a href="#table-valued-parameters">Table-Valued Parameters (SQL Server 2008&#43;)</a>
</li><li><a href="#associative-array-parameters">PL/SQL Associative Array Parameters (Oracle)</a>
</li></ul>
</li><li><a href="#executemultireader">ExecuteMultiReader</a>
<ul>
<li><a href="#column-property-mapping">Column--&gt;Property Mapping</a>
<ul>
<li><a href="#manual-mapping">Manual Mapping</a> </li><li><a href="#automatic-mapping">Automatic Mapping</a> </li></ul>
</li><li><a href="#data-type-mapping">Data Type Mapping</a> </li></ul>
</li><li><a href="#executestoredprocedure">ExecuteStoredProcedure</a> </li></ul>
</li><li><a href="#oraclelauncher">OracleLauncher</a> </li></ul>
</li><li><a href="#api-reference">API Reference</a>
<ul>
<li><a href="#api-dbaccess">DbAccess</a>
<ul>
<li><a href="#api-dbaccess-constructors">Constructors</a> </li><li><a href="#api-dbaccess-static-global">Static Global</a> </li><li><a href="#api-dbaccess-methods">Methods</a>
<ul>
<li><a href="#api-dbaccess-executereader">ExecuteReader</a> </li><li><a href="#api-dbaccess-executemultireader">ExecuteMultiReader</a> </li><li><a href="#api-dbaccess-executenonquery">ExecuteNonQuery</a> </li></ul>
</li><li><a href="#api-dbaccess-dbparameterbuilder">DbParameterBuilder</a> </li><li><a href="#api-dbaccess-dbfieldmap">DbFieldMap</a> </li><li><a href="#api-dbaccess-dbmultiresultset">DbMultiResultSet</a> </li></ul>
</li><li><a href="#api-oraclelauncher">OracleLauncher</a>
<ul>
<li><a href="#api-oraclelauncher-constructors">Constructors</a> </li><li><a href="#api-oraclelauncher-methods">Methods</a>
<ul>
<li><a href="#api-oraclelauncher-post">Post</a> </li></ul>
</li></ul>
</li><li><a href="#api-sqllauncher">SqlLauncher</a>
<ul>
<li><a href="#api-sqllauncher-constructors">Constructors</a> </li><li><a href="#api-sqllauncher-methods">Methods</a>
<ul>
<li><a href="#api-sqllauncher-post">Post</a> </li></ul>
</li></ul>
</li></ul>
</li><li><a href="#nuget-packages">NuGet Packages</a> </li><li><a href="#symbolsource">Debugging Symbols/Sources</a> </li><li><a href="#requirements">Requirements</a> </li><li><a href="#contributions">Contributions</a> </li><li><a href="#support">Support</a> </li></ul>
<p><a name="quick-starts"></a><strong>Quick Starts</strong></p>
<ul>
<li><a name="qs-dbaccess"></a><strong><span style="color:#2b91af">DbAccess</span></strong>:<br>
<a name="simple-parameters"></a>The following examples code shows its 4 different fine-grained user control of usages.
</li></ul>
<div style="color:black; background-color:white">
<pre><span style="color:blue">using</span> System;
<span style="color:blue">using</span> System.Collections.Generic;
<span style="color:blue">using</span> DbParallel.DataAccess;

<span style="color:blue">namespace</span> DbAccessExamples
{
    <span style="color:blue">class</span> Program
    {
        <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args)
        {
            <span style="color:blue">decimal</span> sumAmount = 0m;
            <span style="color:blue">long</span> sumHoldings = 0;

            <span style="color:green">// Example of constructor overload1</span>
            <span style="color:blue">using</span> (<span style="color:#2b91af">DbAccess</span> db = <span style="color:blue">new</span> <span style="color:#2b91af">DbAccess</span>(MyConfigMgr.DbProviderFactory,
                MyConfigMgr.ConnectionString))
            {
                <span style="color:green">//=======================================================================</span>
                <span style="color:green">// Example1: single result set</span>
                db.ExecuteReader(GetProcedure(<span style="color:#a31515">&quot;READ_TEST_DATA1&quot;</span>),
                    parameters =&gt;
                    {
                        parameters.Add(<span style="color:#a31515">&quot;inDate&quot;</span>, <span style="color:#2b91af">DateTime</span>.Today);
                        parameters.Add(<span style="color:#a31515">&quot;inCount&quot;</span>, 300000);
                    },
                    row =&gt;
                    {
                        sumAmount &#43;= row.Field&lt;<span style="color:blue">decimal</span>&gt;(<span style="color:#a31515">&quot;TEST_AMOUNT&quot;</span>);
                    });

                sumAmount = 0m;

                <span style="color:green">//=======================================================================</span>
                <span style="color:green">// Example2: multiple result sets</span>
                db.ExecuteReader(GetProcedure(<span style="color:#a31515">&quot;READ_TEST_DATA2&quot;</span>),
                    parameters =&gt;
                    {
                        parameters.Add(<span style="color:#a31515">&quot;inMarket&quot;</span>, <span style="color:#a31515">&quot;NYSE&quot;</span>);
                        parameters.Add(<span style="color:#a31515">&quot;inDate&quot;</span>, <span style="color:#2b91af">DateTime</span>.Today);
                    },
                    (row, resultSet) =&gt;
                    {
                        <span style="color:blue">switch</span> (resultSet)
                        {
                            <span style="color:blue">case</span> 0:     <span style="color:green">// First result set</span>
                                sumAmount &#43;= row.Field&lt;<span style="color:blue">decimal</span>&gt;(<span style="color:#a31515">&quot;MARKET_VALUE&quot;</span>);
                                <span style="color:blue">break</span>;
                            <span style="color:blue">case</span> 1:     <span style="color:green">// Second result set</span>
                                sumHoldings &#43;= row.Field&lt;<span style="color:blue">long</span>&gt;(<span style="color:#a31515">&quot;HOLDINGS&quot;</span>);
                                <span style="color:blue">break</span>;
                        }
                    });
            }

            <span style="color:green">// Example of constructor overload4</span>
            <span style="color:blue">using</span> (<span style="color:#2b91af">DbAccess</span> db = <span style="color:blue">new</span> <span style="color:#2b91af">DbAccess</span>(<span style="color:#a31515">&quot;MyDbConnKey&quot;</span>))
            {
                List&lt;MyBusiness1&gt; myBusiness1List = <span style="color:blue">new</span> List&lt;MyBusiness1&gt;();
                List&lt;MyBusiness2&gt; myBusiness2List = <span style="color:blue">new</span> List&lt;MyBusiness2&gt;();

                <span style="color:green">//=======================================================================</span>
                <span style="color:green">// Example3: map every result row to a business class by specified column-property mappings</span>
                db.ExecuteReader&lt;MyBusiness1&gt;(GetProcedure(<span style="color:#a31515">&quot;READ_TEST_DATA3&quot;</span>),
                    parameters =&gt;
                    {
                        parameters.Add(<span style="color:#a31515">&quot;inAs_Of_Date&quot;</span>, <span style="color:#2b91af">DateTime</span>.Today);
                    },
                    map =&gt;
                    {
                        map.Add(<span style="color:#a31515">&quot;SEC_ID&quot;</span>, t =&gt; t.Id);
                        map.Add(<span style="color:#a31515">&quot;MARKET_VALUE&quot;</span>, t =&gt; t.MarketValue);
                        map.Add(<span style="color:#a31515">&quot;CLOSE_DATE&quot;</span>, t =&gt; t.CloseDate);
                    },
                    myBusiness1 =&gt;
                    {
                        myBusiness1List.Add(myBusiness1);
                    });

                <span style="color:green">//=======================================================================</span>
                <span style="color:green">// Example4: auto map every result row to a business class by matching database column names with the same name of class properties, ignore mismatched columns.</span>
                db.ExecuteReader&lt;MyBusiness2&gt;(GetProcedure(<span style="color:#a31515">&quot;READ_TEST_DATA4&quot;</span>),
                    parameters =&gt;
                    {
                        parameters.Add(<span style="color:#a31515">&quot;inAs_Of_Date&quot;</span>, <span style="color:#2b91af">DateTime</span>.Today);
                        parameters.Add(<span style="color:#a31515">&quot;inDept_Code&quot;</span>, <span style="color:#a31515">&quot;LOCAL_SALES&quot;</span>);
                    },
                    myBusiness2 =&gt;
                    {
                        myBusiness2List.Add(myBusiness2);
                    });
            }
        }

        <span style="color:green">// Get stored procedure full name [schema.package.sp]</span>
        <span style="color:blue">static</span> <span style="color:blue">string</span> GetProcedure(<span style="color:blue">string</span> sp)
        {
            <span style="color:blue">return</span> MyConfigMgr.DatabasePackage &#43; sp;
        }
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> MyBusiness1
    {
        <span style="color:blue">public</span> <span style="color:blue">int</span> Id { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
        <span style="color:blue">public</span> <span style="color:blue">decimal</span> MarketValue { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
        <span style="color:blue">public</span> <span style="color:#2b91af">DateTime</span>? CloseDate { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> MyBusiness2
    {
        <span style="color:blue">public</span> <span style="color:blue">string</span> Prod_Code { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
        <span style="color:blue">public</span> <span style="color:blue">int</span> Stock { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
        <span style="color:blue">public</span> <span style="color:blue">float</span>? Discount_Rate { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }
    }
}</pre>
</div>
<ul>
<li><a name="db-bulk"></a><a href="https://msdn.microsoft.com/en-us/library/bb675163.aspx" target="_blank">Table-Valued Parameters</a> &amp;
<a href="http://docs.oracle.com/cd/E51173_01/win.122/e17732/featOraCommand.htm#BABBDHBB" target="_blank">
PL/SQL Associative Array Parameters</a>
<ul>
<li><a name="table-valued-parameters"></a><a href="https://msdn.microsoft.com/en-us/library/bb675163.aspx" target="_blank">Table-Valued Parameters</a> (SQL Server 2008&#43;):
<br>
The following example demonstrates how to pass table-valued parameter data to a stored procedure, the tvpValue can be a DataTable, a DbDataReader or a IEnumerable&lt;SqlDataRecord&gt;. In addition, the ToDataTable extension method can convert an IEnumerable&lt;IDictionary&lt;string,
 object&gt;&gt; or a IEnumerable&lt;object&gt; <em>(anonymous type instances or named type instances)</em> into a DataTable.
<div style="color:black; background-color:white">
<pre>....
dbAccess.Execute....(GetProcedure(sp), parameters =&gt;
    {
        parameters.Add(<span style="color:#a31515">&quot;inDate&quot;</span>, date);              <span style="color:#008000">// Simple Parameter</span>
        parameters.AddTableValue(<span style="color:#a31515">&quot;inTvp&quot;</span>, tvpValue); <span style="color:#008000">// Table-Valued Parameter</span>
    },
    ....
);
....
</pre>
</div>
</li><li><a name="associative-array-parameters"></a><a href="http://docs.oracle.com/cd/E51173_01/win.122/e17732/featOraCommand.htm#BABBDHBB" target="_blank">PL/SQL Associative Array Parameters</a> (Oracle):
<br>
The following example demonstrates how to pass PL/SQL Associative Array to a stored procedure, the assocArrayValue must be an array simple data (e.g. int[], decimal[], string[], etc) or an IEnumerable&lt;IConvertible&gt;.
<div style="color:black; background-color:white">
<pre>....
dbAccess.Execute....(GetProcedure(sp), parameters =&gt;
    {
        parameters.Add(<span style="color:#a31515">&quot;inDate&quot;</span>, date); <span style="color:#008000">// Simple Parameter</span>
        parameters.AddAssociativeArray(<span style="color:#a31515">&quot;inAssocArray&quot;</span>, <span style="color:#2b91af">OracleDbType</span>.Decimal,
                      assocArrayValue); <span style="color:#008000">// Associative Array Parameter</span>
    },
    ....
);
....
</pre>
</div>
</li></ul>
</li></ul>
<ul>
<li><a name="executemultireader"></a><span style="color:#2b91af">ExecuteMultiReader</span>:<br>
Multi-ResultSet is a common scenario in package based (Oracle) or stored procedure based (SQL Server) database development, using the ExecuteMultiReader Method can minimize your DAL code to process multiple results.
</li></ul>
<div style="color:black; background-color:white">
<pre><span style="color:blue">internal</span> <span style="color:blue">static</span> <span style="color:#2b91af">Tuple</span>&lt;<span style="color:#2b91af">List</span>&lt;MyBusiness1&gt;, <span style="color:#2b91af">List</span>&lt;MyBusiness2&gt;, <span style="color:#2b91af">List</span>&lt;MyBusiness3&gt;&gt; ViewReport(<span style="color:blue">this</span> <span style="color:#2b91af">DbAccess</span> dbAccess, <span style="color:#2b91af">DateTime</span> date, <span style="color:#2b91af">int</span> sessionId)
{
    <span style="color:blue">const</span> <span style="color:#2b91af">string</span> sp = <span style="color:#a31515">&quot;VIEW_REPORT&quot;</span>;

    <span style="color:blue">var</span> resultTuple = <span style="color:#2b91af">Tuple</span>.Create(<span style="color:blue">new</span> <span style="color:#2b91af">List</span>&lt;MyBusiness1&gt;(), <span style="color:blue">new</span> <span style="color:#2b91af">List</span>&lt;MyBusiness2&gt;(), <span style="color:blue">new</span> <span style="color:#2b91af">List</span>&lt;MyBusiness3&gt;());

    dbAccess.ExecuteMultiReader(GetProcedure(sp), parameters =&gt;
        {
            parameters.Add(<span style="color:#a31515">&quot;inDate&quot;</span>,    date);
            parameters.Add(<span style="color:#a31515">&quot;inSession&quot;</span>, sessionId);
        }, resultSets =&gt;
            {
                <span style="color:#008000">// Specified fields mapping example</span>
                resultSets.Add(resultTuple.Item1, colMap =&gt;  <span style="color:#008000">// 1st ResultSet</span>
                    {
                        colMap.Add(<span style="color:#a31515">&quot;SEC_ID&quot;</span>,        t =&gt; t.Id);
                        colMap.Add(<span style="color:#a31515">&quot;MARKET_VALUE&quot;</span>,  t =&gt; t.MarketValue);
                        colMap.Add(<span style="color:#a31515">&quot;CLOSE_DATE&quot;</span>,    t =&gt; t.CloseDate);
                    });

                <span style="color:#008000">// Full-automatic (case-insensitive) fields mapping examples</span>
                resultSets.Add(resultTuple.Item2);   <span style="color:#008000">// 2nd ResultSet</span>
                resultSets.Add(resultTuple.Item3);   <span style="color:#008000">// 3rd ResultSet</span>
            }
    );

    <span style="color:blue">return</span> resultTuple;
}
</pre>
</div>
<div style="padding-left:40px"><br>
Normally, all these method calls and their parameters should be wrapped in your DAL.<br>
Further, the user class (e.g. above MyBusiness2 class) can be auto generated by the utility under UtilityScripts folder.
<ul>
<li><a name="column-property-mapping"></a>Column--&gt;Property Mapping
<ul>
<li><a name="manual-mapping"></a>You can explicitly specify which database column map to which property or field of your strongly typed class. E.g.
<div style="color:black; background-color:white">
<pre>....
colMap.Add(<span style="color:#a31515">&quot;BUY_AMOUNT&quot;</span>,  t =&gt; t.Cost);
colMap.Add(<span style="color:#a31515">&quot;ISSUER_REGION&quot;</span>,  t =&gt;
           t.NestedProperty.DeeperField.Issuer.Region.IsoCode);
....</pre>
</div>
To allow map a database column to a deep Properties or Fields in .Net, please make sure that,
<ol>
<li>All nested properties or fields (above e.g. NestedProperty, DeeperField, Issuer and Region) run through in middle levels must be:
<ul>
<li>Class only. Struct is not supported; </li><li>The class has public parameterless constructor (or by default); </li><li>The nested propertie/field has both read and write accessibility. </li></ul>
</li><li>The end property or field (above e.g. Cost and IsoCode) must be:
<ul>
<li>A value type or string type; <em>(Implement IConvertible interface)</em> </li><li>With both read and write accessibility. </li></ul>
</li><li>There is no limit to the number of how many levels through the path from the root class object to the end property or field.
</li></ol>
</li><li><a name="automatic-mapping"></a>If you don't explicitly specify mapping (omit the whole parameter at all), the full-auto-mapping mechanism will be activated to match database columns with .Net one level properties/fields as more as possible. Following
 is the matching precedence:
<ol>
<li>Match the names of database columns with the names of .Net properties/fields in a case-sensitive manner;
</li><li>Match the rest in a case-insensitive manner; </li><li>De-underscore(compact) the rest of database column names (as we know, most Oracle users adopt underscores naming convention), then match the rest names with rest .Net properties/fields in a case-insensitive manner. - v1.7.6.2&#43;<br>
E.g. A database column named &quot;USER_FIRST_NAME&quot; will auto-map to a .Net property named UserFirstName (or userFirstName).
</li></ol>
</li></ul>
&nbsp; </li><li><a name="data-type-mapping"></a><u>Data Type Mapping</u><br>
Supported mapping of Database Engine Data Types to .NET Common Language Runtime Types relies on two levels conversion:<br>
<div style="padding-left:40px"><img src="Home_type-mapping.png" alt="Data Type Mapping"></div>
<ol>
<li>ADO.NET Provider converts database data type into inferred .NET Framework data type;
</li><li>If level 1 conversion has not yet reached business target type, an appropriate
<a href="http://msdn.microsoft.com/en-us/library/system.iconvertible.aspx" target="_blank">
IConvertible</a> method of the inferred .NET Framework type will be called automatically to convert further into the target type.
</li></ol>
</li></ul>
</div>
<ul>
<li><a name="executestoredprocedure"></a><span style="color:#2b91af">ExecuteStoredProcedure</span>:<br>
In data-driven application developments, there are also a large number of scenarios without substantial logic in data access web services, however they wasted a lot of our efforts on very boring data moving coding or configuration. The
<span style="color:#2b91af">ExecuteStoredProcedure</span> provides you an accessibility to implement an entirely generic ASP.NET Web API (RESTful). Please refer to the following example:
</li></ul>
<div style="color:black; background-color:white">
<pre><span style="color:#0000ff">public</span> <span style="color:#0000ff">class</span> <span style="color:#2b91af">DbWebApiController</span> : <span style="color:#2b91af">ApiController</span>
{
    [<span style="color:#2b91af">DbWebApiAuthorize</span>]
    [<span style="color:#2b91af">AcceptVerbs</span>(<span style="color:#a31515">&quot;GET&quot;</span>, <span style="color:#a31515">&quot;POST&quot;</span>, <span style="color:#a31515">&quot;PUT&quot;</span>, <span style="color:#a31515">&quot;DELETE&quot;</span>)]
    <span style="color:#0000ff">public</span> <span style="color:#2b91af">StoredProcedureResponse</span> Execute(<span style="color:#0000ff">string</span> sp,
                                           <span style="color:#2b91af">IDictionary</span>&lt;<span style="color:#0000ff">string</span>, <span style="color:#0000ff">object</span>&gt; parameters)
    {
        <span style="color:#2b91af">StoredProcedureRequest</span> spRequest = <span style="color:#0000ff">new</span> <span style="color:#2b91af">StoredProcedureRequest</span>(sp,parameters);

        <span style="color:#0000ff">using</span> (<span style="color:#2b91af">DbAccess</span> dbAccess = <span style="color:#2b91af">DbPackage</span>.CreateConnection())
        {
            <span style="color:#0000ff">return</span> dbAccess.<strong>ExecuteStoredProcedure</strong>(spRequest);
        }
    }
}
</pre>
</div>
<div style="padding-left:40px"><br>
Http clients can use Stored Procedure Name or Database Function Name as endpoint (e.g. http://BaseURL/YourStoredProcedureName) without programming effort, no special configuration is required to expose a stored procedure or function. Just put required parameters
 in JSON format request body (Content-Type: &quot;application/json&quot;). The response JSON (Accept: application/json) or XML (Accept: application/xml) will have all Result Sets, Output Parameters and Return Value.<br>
Please visit <a href="//github.com/DataBooster/DbWebApi/wiki" target="_blank">
https://github.com/DataBooster/DbWebApi/wiki</a> for more information about <a href="//github.com/DataBooster/DbWebApi" target="_blank">
DbWebApi</a>.</div>
<div style="padding-left:40px"><br>
If you are building an entirely generic ASP.NET SignalR application, this ExecuteStoredProcedure method can also be used directly.</div>
<div style="padding-left:40px; color:black; background-color:white">
<pre><span style="color:#2b91af">StoredProcedureResponse</span> ExecuteStoredProcedure(<span style="color:#2b91af">StoredProcedureRequest</span> request);</pre>
</div>
<ul>
<li><a name="oraclelauncher"></a><strong><span style="color:#2b91af">OracleLauncher</span></strong>:<br>
A quick example: </li></ul>
<div style="color:black; background-color:white">
<pre><span style="color:blue">using</span> System;
<span style="color:blue">using</span> System.Threading.Tasks;
<span style="color:blue">using</span> DbParallel.DataAccess.Booster.Oracle;
<span style="color:blue">using</span> DDTek.Oracle;

<span style="color:blue">namespace</span> OracleLauncherExamples
{
    <span style="color:blue">class</span> Program
    {
        <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args)
        {
            <span style="color:blue">using</span> (<span style="color:#2b91af">OracleLauncher</span> launcher = <span style="color:blue">new</span> <span style="color:#2b91af">OracleLauncher</span>(ConfigurationManager.ConnectionStrings[<span style="color:#a31515">&quot;MyDbConnKey&quot;</span>].ConnectionString,
                <span style="color:#a31515">&quot;SCHEMA.PACKAGE.WRITE_BULK_DATA&quot;</span><span style="color:green">/* stored procedure */</span>,
                parameters =&gt;
                {
                    parameters.Add(<span style="color:#a31515">&quot;inGroup_ID&quot;</span>, 1001);     <span style="color:green">// Ordinary parameter</span>
                    parameters.AddAssociativeArray(<span style="color:#a31515">&quot;inItem_IDs&quot;</span>,
                        OracleDbType.Int32);
                    parameters.AddAssociativeArray(<span style="color:#a31515">&quot;inItem_Values&quot;</span>,
                        OracleDbType.Double);
                }))
            {
                Parallel.For(0, 100, i =&gt;   <span style="color:green">// Just simulating multiple(100) producers</span>
                {
                    <span style="color:blue">for</span> (<span style="color:blue">int</span> j = 0; j &lt; 200000; j&#43;&#43;)
                    {
                        AddRow(launcher, i * 200000 &#43; j, (<span style="color:blue">double</span>)j * 0.618);
                    }
                });

                <span style="color:green">// launcher.Complete(); // This is not necessary because here creates the instance with a using statement, the Complete method will be called by Dispose method automatically.</span>
            }
        }

        <span style="color:blue">static</span> <span style="color:blue">void</span> AddRow(<span style="color:#2b91af">OracleLauncher</span> launcher, <span style="color:blue">int</span> itemId, <span style="color:blue">double</span> itemValue)
        {
            launcher.Post(itemId, itemValue);
        }
    }
}
</pre>
</div>
<div style="padding-left:40px">The database side stored procedure is like following:
<div style="color:black; background-color:white">
<pre><span style="color:blue">TYPE</span> NUMBER_ARRAY <span style="color:blue">IS</span> <span style="color:blue">TABLE</span> <span style="color:blue">OF</span> NUMBER <span style="color:blue">INDEX</span> <span style="color:blue">BY</span> PLS_INTEGER;
<span style="color:blue">TYPE</span> DOUBLE_ARRAY <span style="color:blue">IS</span> <span style="color:blue">TABLE</span> <span style="color:blue">OF</span> BINARY_DOUBLE <span style="color:blue">INDEX</span> <span style="color:blue">BY</span> PLS_INTEGER;

<span style="color:blue">PROCEDURE</span> WRITE_BULK_DATA
(
    inGroup_ID      NUMBER,
    inItem_IDs      NUMBER_ARRAY,
    inItem_Values   DOUBLE_ARRAY
)   <span style="color:blue">AS</span>
<span style="color:blue">BEGIN</span>
    FORALL i <span style="color:blue">IN</span> inItem_IDs.FIRST .. inItem_IDs.LAST
    <span style="color:blue">INSERT</span> <span style="color:green">/*&#43; APPEND_VALUES */</span> <span style="color:blue">INTO</span> XYZ.TEST_WRITE_DATA
    (
        GROUP_ID,
        ITEM_ID,
        ITEM_VALUE
    )
    <span style="color:blue">VALUES</span>
    (
        inGroup_ID,
        inItem_IDs(i),
        inItem_Values(i)
    );
    <span style="color:blue">COMMIT</span>;
<span style="color:blue">END</span> WRITE_BULK_DATA;</pre>
</div>
</div>
<div>&nbsp;</div>
<p><a name="api-reference"></a><strong>API Reference</strong></p>
<ul>
<li><a name="api-dbaccess"></a><strong><span style="text-decoration:underline; color:#2b91af">DbAccess</span></strong><br>
(Namespace: DbParallel.DataAccess) </li></ul>
<div style="margin-left:40px"><a name="api-dbaccess-constructors"></a><strong>Constructors</strong>
<span style="color:#808080">(4 overloads)</span>:
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> DbAccess(<span style="color:#2b91af">DbProviderFactory</span> dbProviderFactory, <span style="color:blue">string</span> connectionString);
<span style="color:blue">public</span> DbAccess(<span style="color:blue">string</span> providerName, <span style="color:blue">string</span> connectionString);
<span style="color:blue">public</span> DbAccess(<span style="color:#2b91af">ConnectionStringSettings</span> connSetting);
<span style="color:blue">public</span> DbAccess(<span style="color:blue">string</span> connectionStringKey);</pre>
</div>
<div><br>
<a name="api-dbaccess-static-global"></a><strong>Static Global</strong><br>
<span style="color:blue">public static</span> <span style="color:#2b91af">CommandType</span> DefaultCommandType {
<span style="color:blue">get</span>; <span style="color:blue">set</span>; }<br>
&nbsp; &nbsp; The default is <strong>StoredProcedure</strong>.<br>
&nbsp;</div>
<div><a name="api-dbaccess-methods"></a><strong>Methods</strong><br>
<a name="api-dbaccess-executereader"></a>- ExecuteReader <span style="color:#808080">
(9 overloads)</span>:</div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">void</span> ExecuteReader(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbDataReader</span>&gt; dataReader);

<span style="color:blue">void</span> ExecuteReader(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbDataReader</span>&gt; dataReader);

<span style="color:#2b91af">IEnumerable</span>&lt;T&gt; ExecuteReader&lt;T&gt;(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;&gt; resultMap = <span style="color:blue">null</span>) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();

<span style="color:#2b91af">IEnumerable</span>&lt;T&gt; ExecuteReader&lt;T&gt;(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;&gt; resultMap = <span style="color:blue">null</span>) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();

<span style="color:blue">void</span> ExecuteReader&lt;T&gt;(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;&gt; resultMap, <span style="color:#2b91af">Action</span>&lt;T&gt; readEntity) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();

<span style="color:blue">void</span> ExecuteReader&lt;T&gt;(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;T&gt; readEntity) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();

<span style="color:blue">void</span> ExecuteReader&lt;T&gt;(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;&gt; resultMap, <span style="color:#2b91af">Action</span>&lt;T&gt; readEntity) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();

<span style="color:blue">void</span> ExecuteReader(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbDataReader</span>, <span style="color:blue">int</span><span style="color:green">/*resultSet*/</span>&gt; dataReaders); <span style="color:green">// For multiple result set</span>

<span style="color:blue">void</span> ExecuteReader(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbDataReader</span>, <span style="color:blue">int</span><span style="color:green">/*resultSet*/</span>&gt; dataReaders); <span style="color:green">// For multiple result set</span></pre>
</div>
<div><a name="api-dbaccess-dbparameterbuilder"></a><span style="color:#2b91af">- DbParameterBuilder</span></div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> <span style="color:#2b91af">DbParameter DbParameterBuilder</span>.Add(<span style="color:blue">string</span> parameterName, <span style="color:blue">object</span> oValue, <span style="color:blue">int</span> nSize = 0); <span style="color:green">// Direction defaults to ParameterDirection.Input</span>

<span style="color:blue">public</span> <span style="color:#2b91af">DbParameter DbParameterBuilder</span>.AddReturn(<span style="color:blue">string</span> parameterName = <span style="color:#a31515">&quot;RETURN_VALUE&quot;</span>, <span style="color:#2b91af">DbType</span> dbType = <span style="color:#2b91af">DbType</span>.Int32, <span style="color:blue">int</span> nSize = 0);

<span style="color:blue">public</span> <span style="color:#2b91af">DbParameter DbParameterBuilder</span>.AddOutput(<span style="color:blue">string</span> parameterName, <span style="color:#2b91af">DbType</span> dbType, <span style="color:blue">int</span> nSize = 0);</pre>
</div>
<div><a name="api-dbaccess-dbfieldmap"></a><span style="color:#2b91af">- DbFieldMap</span></div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> <span style="color:#2b91af">DbFieldMap</span>&lt;T&gt; <span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;.Add(string columnName, <span style="color:#2b91af">Expression</span>&lt;<span style="color:#2b91af">Func</span>&lt;T, <span style="color:blue">object</span>&gt;&gt; fieldExpr);</pre>
</div>
<div><a name="api-dbaccess-executemultireader"></a>- ExecuteMultiReader <span style="color:#808080">
(2 overloads)</span>:</div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> <span style="color:blue">void</span> ExecuteMultiReader(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbMultiResultSet</span>&gt; multiResultSetMap);

<span style="color:blue">public</span> <span style="color:blue">void</span> ExecuteMultiReader(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbMultiResultSet</span>&gt; multiResultSetMap);
</pre>
</div>
<div><a name="api-dbaccess-dbmultiresultset"></a><span style="color:#2b91af">- DbMultiResultSet</span></div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">public void</span> <span style="color:#2b91af">DbMultiResultSet</span>.Add&lt;T&gt;(<span style="color:#2b91af">ICollection</span>&lt;T&gt; resultSet, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbFieldMap</span>&lt;T&gt;&gt; resultMap = <span style="color:blue">null</span>) <span style="color:blue">where</span> T : <span style="color:blue">new</span>();</pre>
</div>
<div><a name="api-dbaccess-executenonquery"></a>- ExecuteNonQuery <span style="color:#808080">
(2 overloads)</span>:</div>
<div style="color:black; background-color:white">
<pre><span style="color:blue">int</span> ExecuteNonQuery(<span style="color:blue">string</span> commandText, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder = <span style="color:blue">null</span>);

<span style="color:blue">int</span> ExecuteNonQuery(<span style="color:blue">string</span> commandText, <span style="color:blue">int</span> commandTimeout, <span style="color:#2b91af">CommandType</span> commandType, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder);</pre>
</div>
</div>
<ul>
<li><a name="api-oraclelauncher"></a><strong><span style="text-decoration:underline; color:#2b91af">OracleLauncher</span></strong><br>
(Namespace: DbParallel.DataAccess.Booster.Oracle) </li></ul>
<div style="margin-left:40px"><a name="api-oraclelauncher-constructors"></a><strong>Constructors</strong>:
<div style="color:black; background-color:white">
<pre>OracleLauncher(<span style="color:blue">string</span> connectionString, <span style="color:blue">string</span> storedProcedure, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">DbParameterBuilder</span>&gt; parametersBuilder, <span style="color:blue">int</span> multipleRockets = _DefaultMultipleRockets, <span style="color:blue">int</span> bulkSize = _DefaultBulkSize, <span style="color:blue">int</span> commandTimeout = _CommandTimeout);
</pre>
</div>
<div>The <em>_DefaultMultipleRockets</em> is <span style="color:#ff0000">6</span>:</div>
<div><img src="Home_multi-rockets.png" alt="Multiple Rockets" width="360" height="180" style="vertical-align:middle"></div>
<p><br>
<a name="api-oraclelauncher-methods"></a><strong>Methods</strong><br>
<a name="api-oraclelauncher-post"></a>- Post:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">void</span> Post(<span style="color:blue">params</span> <span style="color:blue">object</span>[] values);</pre>
</div>
Your application DAL should wrap this method as strong type parameters, like following example:
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> <span style="color:blue">void</span> AddQuote(<span style="color:blue">int</span> id, <span style="color:#2b91af">DateTime</span> time, <span style="color:blue">int</span> level, <span style="color:blue">decimal</span> price)
{
    _launcher.Post(id, time, level, price);
}
</pre>
</div>
</div>
<ul>
<li><a name="api-sqllauncher"></a><strong><span style="text-decoration:underline; color:#2b91af">SqlLauncher</span></strong><br>
(Namespace: DbParallel.DataAccess.Booster.SqlServer) </li></ul>
<div style="margin-left:40px"><a name="api-sqllauncher-constructors"></a><strong>Constructors</strong>:
<div style="color:black; background-color:white">
<pre>SqlLauncher(<span style="color:blue">string</span> connectionString, <span style="color:blue">string</span> destinationTableName, <span style="color:#2b91af">Action</span>&lt;<span style="color:#2b91af">SqlBulkCopyColumnMappingCollection</span>&gt; columnMappings = <span style="color:blue">null</span>, <span style="color:blue">int</span> multipleRockets = _DefaultMultipleRockets, <span style="color:blue">int</span> bulkSize = _DefaultBulkSize, <span style="color:blue">int</span> commandTimeout = _CommandTimeout);
</pre>
</div>
<p>Detail for destinationTableName and <span style="color:#2b91af">SqlBulkCopyColumnMappingCollection</span>, please refer to
<a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.destinationtablename.aspx" target="_blank">
SqlBulkCopy.DestinationTableName</a>, <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.columnmappings.aspx" target="_blank">
SqlBulkCopy.ColumnMappings</a> and <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopycolumnmappingcollection.aspx" target="_blank">
SqlBulkCopyColumnMappingCollection</a> on MSDN.</p>
<p><a name="api-sqllauncher-methods"></a><strong>Methods</strong><br>
<a name="api-sqllauncher-post"></a>- Post: The same as <a href="#api-oraclelauncher-post">
<span style="color:#2b91af">OracleLauncher</span></a></p>
</div>
<div><a name="nuget-packages"></a><strong>NuGet Packages</strong></div>
<div style="padding-left:30px">It is strongly recommended to use this library through NuGet Library Package Manager right in Visual Studio. NuGet Packages can also generate some scaffolding, sample code and configuration into your project for a very quick start
 from the ground.
<table>
<tbody>
<tr>
<td align="center">Package</td>
<td align="center">Package ID</td>
</tr>
<tr>
<td>DataBooster for SQL Server</td>
<td><a href="//www.nuget.org/packages/DataBooster.SqlServer" target="_blank">DataBooster.SqlServer</a></td>
</tr>
<tr>
<td>DataBooster for SQL Server &#43; Oracle (use ODP.NET Provider)</td>
<td><a href="//www.nuget.org/packages/DataBooster.Oracle.ODP" target="_blank">DataBooster.Oracle.ODP</a></td>
</tr>
<tr>
<td>DataBooster for SQL Server &#43; Oracle (use ODP.NET Managed Driver) &nbsp;</td>
<td><a href="//www.nuget.org/packages/DataBooster.Oracle.Managed" target="_blank">DataBooster.Oracle.Managed</a></td>
</tr>
<tr>
<td>DataBooster for SQL Server &#43; Oracle (use DataDirect Provider)</td>
<td><a href="//www.nuget.org/packages/DataBooster.Oracle.DataDirect" target="_blank">DataBooster.Oracle.DataDirect</a> &nbsp;</td>
</tr>
</tbody>
</table>
<img src="Home_multi-rockets.png" alt=""><br>
<br>
All sample code is only available in DEBUG mode, you can even turn off sample code in DEBUG mode easily, just add NO_SAMPLE into your project Conditional Compilation Symbols (Visual Studio Project Properties Dialog -&gt; Build -&gt; General -&gt; Conditional
 Compilation Symbols).<br>
&nbsp;</div>
<div><a name="symbolsource"></a><strong>Debugging Symbols/Sources</strong></div>
<div style="padding-left:30px">Associated Symbol Packages with above NuGet Packages are also available in http://srv.symbolsource.org/pdb/Public.
<br>
To source step during debugging into the code of DataBooster library, please see <a href="http://www.symbolsource.org/Public/Home/VisualStudio" target="_blank">
SymbolSource.org</a> for detailed instructions.</div>
<div>&nbsp;</div>
<p><a name="requirements"></a><strong>Requirements</strong></p>
<ul>
<li>.NET Framework 4.0 or later. </li><li>Oracle ADO.NET Provider (Optional):<br>
- ODP.NET 4 (Reference: Oracle.DataAccess.dll; Conditional Compilation Symbols: &quot;ORACLE;ODP_NET&quot;)<br>
or<br>
- ODP.NET Managed Driver (Reference: Oracle.ManagedDataAccess.dll; Conditional Compilation Symbols: &quot;ORACLE;ODP_NET_MANAGED&quot;)<br>
or<br>
- DataDirect Connect for ADO.NET (Reference: DDTek.Oracle.dll; Conditional Compilation Symbols: &quot;ORACLE;DATADIRECT&quot;)<br>
or<br>
<em>(the provider can be easily replaced by other provider for Oracle)</em> </li></ul>
<p><a name="contributions"></a><strong>Contributions</strong></p>
<ul>
<li>Welcome all feedback through the CodePlex project (through comments, patches, or items in the Issue Tracker);
</li><li>Needs to add support for other databases; </li><li>Looking for Clean-Style Developers, Testers and Editors. </li></ul>
<div><a name="support"></a><strong>Support</strong></div>
<div style="padding-left:30px">Feel free to use the source or binaries in your apps, and products.<br>
This project is developed in personal time, the source code support can be available only at night -<br>
Easten Time.</div>
</div><div class="ClearBoth"></div>
</body>
</html>
